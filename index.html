<html>
	<head>
	<!--
	
	Developer: @GaryAlmas
	Graphy, simple sketch app using Fabric.js, Free Drawing.
	
	v0.0.1:
		Simplified FreeDrawing.
		Add resize function, to make canvas fit the width and height of device.
		
	-->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
	<script src="assets/fabric/fabric.full.js"></script>	
	<script>
		function resize(){
			var lowercanvas = document.getElementById("playGround");
			lowercanvas.width = document.body.clientWidth;
			lowercanvas.height = document.body.clientHeight;	
		}
	</script>
		<style>
			@font-face {
				font-family: Oxygen;
				src: url('assets/fonts/Oxygen.ttf');
			}
			body{
				width: 100%;
				height: 100%;
				margin: 0px;
			}
			.canvas-container{
				width: 100% !absolute;
				height: 100% !absolute;
			}
		</style>
	</head>
	<body >
		<canvas  id="playGround"style="width: 100%; height: 100%"></canvas>
		<script>
			//Resize the canvas before fabric.js process it
			resize();
		</script>
			
		<div style="display: none; margin-left: 10px">
			<button id="drawing-mode" class="btn btn-info">Cancel drawing mode</button><br>
			<button id="clear-canvas" class="btn btn-info">Clear</button><br>

			<div id="drawing-mode-options">
				<label for="drawing-mode-selector">Mode:</label>
				<select id="drawing-mode-selector">
				  <option>Pencil</option>
				  <option>Circle</option>
				  <option>Spray</option>
				  <option>Pattern</option>

				  <option>hline</option>
				  <option>vline</option>
				  <option>square</option>
				  <option>diamond</option>
				  <option>texture</option>
				</select><br>

				<label for="drawing-line-width">Line width:</label>
				<span class="info">5</span><input type="range" value="5" min="0" max="150" id="drawing-line-width"><br>

				<label for="drawing-color">Line color:</label>
				<input type="color" value="#005E7A" id="drawing-color"><br>

				<label for="drawing-shadow-color">Shadow color:</label>
				<input type="color" value="#005E7A" id="drawing-shadow-color"><br>

				<label for="drawing-shadow-width">Shadow width:</label>
				<span class="info">0</span><input type="range" value="0" min="0" max="50" id="drawing-shadow-width"><br>

				<label for="drawing-shadow-offset">Shadow offset:</label>
				<span class="info">0</span><input type="range" value="0" min="0" max="50" id="drawing-shadow-offset"><br>
			</div>
		</div>
		<script id="main">(function() {
		  var $ = function(id){return document.getElementById(id)};

		  var canvas = this.__canvas = new fabric.Canvas('playGround', {
			isDrawingMode: true
		  });

		  fabric.Object.prototype.transparentCorners = false;

		  var drawingModeEl = $('drawing-mode'),
			  drawingOptionsEl = $('drawing-mode-options'),
			  drawingColorEl = $('drawing-color'),
			  drawingShadowColorEl = $('drawing-shadow-color'),
			  drawingLineWidthEl = $('drawing-line-width'),
			  drawingShadowWidth = $('drawing-shadow-width'),
			  drawingShadowOffset = $('drawing-shadow-offset'),
			  clearEl = $('clear-canvas');

		  clearEl.onclick = function() { canvas.clear() };

		  drawingModeEl.onclick = function() {
			canvas.isDrawingMode = !canvas.isDrawingMode;
			if (canvas.isDrawingMode) {
			  drawingModeEl.innerHTML = 'Cancel drawing mode';
			  drawingOptionsEl.style.display = '';
			}
			else {
			  drawingModeEl.innerHTML = 'Enter drawing mode';
			  drawingOptionsEl.style.display = 'none';
			}
		  };

		  $('drawing-mode-selector').onchange = function() {
			  canvas.freeDrawingBrush = new fabric[this.value + 'Brush'](canvas);

			if (canvas.freeDrawingBrush) {
			  canvas.freeDrawingBrush.color = drawingColorEl.value;
			  canvas.freeDrawingBrush.width = parseInt(drawingLineWidthEl.value, 10) || 1;
			  canvas.freeDrawingBrush.shadowBlur = parseInt(drawingShadowWidth.value, 10) || 0;
			}
		  };

		  if (canvas.freeDrawingBrush) {
			canvas.freeDrawingBrush.color = drawingColorEl.value;
			canvas.freeDrawingBrush.width = parseInt(drawingLineWidthEl.value, 10) || 1;
			canvas.freeDrawingBrush.shadowBlur = 0;
		  }
		})();
		</script>
		<script>
			(function() {
				fabric.util.addListener(fabric.window, 'load', function() {
					var canvas = this.__canvas || this.canvas,
					canvases = this.__canvases || this.canvases;

					canvas && canvas.calcOffset && canvas.calcOffset();

					if (canvases && canvases.length) {
						for (var i = 0, len = canvases.length; i < len; i++) {
						canvases[i].calcOffset();
						}
					}
				});
			})();
		</script>
	</body>
</html>